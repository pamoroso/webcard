(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "INTERLISP" BASE 10)

(FILECREATED " 3-Oct-2024 14:04:08" {DSK}<home>paolo>il>webcard>WEBCARD.;3 2700   

      :EDIT-BY "PA"

      :CHANGES-TO (FNS WCD.MakeWebCard WCD.AskURL)
                  (VARS WEBCARDCOMS)

      :PREVIOUS-DATE " 1-Oct-2024 17:56:57" {DSK}<home>paolo>il>webcard>WEBCARD.;2)


(PRETTYCOMPRINT WEBCARDCOMS)

(RPAQQ WEBCARDCOMS ((* A NoteCards extension for visiting websites.)
                    (FNS WCD.AskURL WCD.CreateWebCardType WCD.MakeWebCard)
                    (P (WCD.CreateWebCardType))))



(* A NoteCards extension for visiting websites.)

(DEFINEQ

(WCD.AskURL
  [LAMBDA (MainWindow)                                       (* ; "Edited  3-Oct-2024 14:00 by PA")

         (* Ask for a URL in a dialog attached to MainWindow and return the URL.
         If MainWindow is NIL then the top level prompt window is used.)
                                                             (* TODO Do at least some URL 
                                                             validation.)
    (bind (URL _ NIL) until URL do (SETQ URL (NCP.AskUser "Enter a URL" "--> " NIL T MainWindow NIL 
                                                    NIL T)) finally (RETURN URL])

(WCD.CreateWebCardType
  [LAMBDA NIL                                                (* ; "Edited  1-Oct-2024 17:35 by PA")
                                                             (* Define the new card type Web that 
                                                             inherits from Text.)
    (NCP.CreateCardType 'Web 'Text '((MakeFn WCD.MakeWebCard))
           `((LinkAnchorModesSupported NIL)
             (DisplayedInMenuFlg T])

(WCD.MakeWebCard
  [LAMBDA (Card Title NoDisplayFlg)                          (* ; "Edited  3-Oct-2024 13:58 by PA")
                                                             (* ; "Edited  1-Oct-2024 17:51 by PA")

         (* Make a new card of type Web. Return the window of the new card if NoDisplayFlg 
         is non-NIL, and the ID if NoDisplayFlg is NIL.)

    (if (NOT NoDisplayFlg)
        then (LET ((Window (NCP.ApplySuperTypeFn MakeFn Card Card Title NoDisplayFlg)))
                  (NCP.CardProp Card 'URL (WCD.AskURL Window))
                  (NCP.CardTitle Card "Untitled")
                  Window)
      else (NCP.CardProp Card 'URL (WCD.AskURL))             (* TODO More Text card initialization 
                                                             here.)
           Card])
)

(WCD.CreateWebCardType)
(DECLARE%: DONTCOPY
  (FILEMAP (NIL (644 2648 (WCD.AskURL 654 . 1312) (WCD.CreateWebCardType 1314 . 1781) (WCD.MakeWebCard 
1783 . 2646)))))
STOP
